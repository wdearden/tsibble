<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A family of window functions â€¢ tsibble</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="A family of window functions">
<meta property="og:description" content="">
<meta property="og:image" content="https://tsibble.tidyverts.org/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tsibble</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro-tsibble.html">Introduction to tsibble</a>
    </li>
    <li>
      <a href="../articles/implicit-na.html">Handle implicit missingess with tsibble</a>
    </li>
    <li>
      <a href="../articles/window.html">Window functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/faq.html">FAQ</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tidyverts/tsibble">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>A family of window functions</h1>
                        <h4 class="author">Earo Wang</h4>
            
      
      
      <div class="hidden name"><code>window.Rmd</code></div>

    </div>

    
    
<p>Time series come with a strict temporal order that dictate the type of operations that can be done. An example of operation is the moving average, where a window slides over the time order and averages of the response are computed on the temporal subset. The tsibble package provides three moving window operations, called verbs that operate on temporal data objects (nouns):</p>
<ul>
<li>
<code><a href="../reference/slide.html">slide()</a></code>/<code><a href="../reference/slide2.html">slide2()</a></code>/<code><a href="../reference/slide2.html">pslide()</a></code>: sliding window with overlapping observations.</li>
<li>
<code><a href="../reference/tile.html">tile()</a></code>/<code><a href="../reference/tile2.html">tile2()</a></code>/<code><a href="../reference/tile2.html">ptile()</a></code>: tiling window without overlapping observations.</li>
<li>
<code><a href="../reference/stretch.html">stretch()</a></code>/<code><a href="../reference/stretch2.html">stretch2()</a></code>/<code><a href="../reference/stretch2.html">pstretch()</a></code>: fixing an initial window and expanding to include more observations.</li>
</ul>
<p>These functions handle all sorts of objects and feature <em>purrr</em>-like interface. In this vignette, I will walk you through the <code><a href="../reference/slide.html">slide()</a></code> and its variants, but the example snippets are also applicable to <code><a href="../reference/tile.html">tile()</a></code> and <code><a href="../reference/stretch.html">stretch()</a></code>.</p>
<p>In spirit of <code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map()</a></code>, <code><a href="../reference/slide.html">slide()</a></code> accepts one input, <code><a href="../reference/slide2.html">slide2()</a></code> two inputs, and <code><a href="../reference/slide2.html">pslide()</a></code> multiple inputs, all of which always return lists for the sake of type stability. Other variants including <code><a href="../reference/slide.html">slide_lgl()</a></code>, <code><a href="../reference/slide.html">slide_int()</a></code>, <code><a href="../reference/slide.html">slide_dbl()</a></code>, <code><a href="../reference/slide.html">slide_chr()</a></code> return vectors of the corresponding type, as well as <code><a href="../reference/slide.html">slide_dfr()</a></code> and <code><a href="../reference/slide.html">slide_dfc()</a></code> for row-binding and column-binding data frames respectively. This full-fledged window family empowers users to build window-related workflows in all sorts of ways, from fixed window size to calendar periods, and from moving average to model fitting.</p>
<p>The <code>pedestrian</code> dataset includes hourly pedestrian counts in the city of Melbourne, with <code>Sensor</code> as key and <code>Date_Time</code> as index. These windowed functions are index-based rolling for tackling general problems, rather than time indexed. Implicit missing values are thereby made explicit using <code><a href="../reference/fill_gaps.html">fill_gaps()</a></code>, and <code>.full = TRUE</code> warrants the equal time length of each sensor. This prepares the data inputs in the expected order.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tsibble)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">pedestrian_full &lt;-<span class="st"> </span>pedestrian <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/fill_gaps.html">fill_gaps</a></span>(<span class="dt">.full =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">pedestrian_full</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; # A tsibble: 70,176 x 5 [1h] &lt;Australia/Melbourne&gt;</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; # Key:       Sensor [4]</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;   Sensor         Date_Time           Date        Time Count</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;   &lt;chr&gt;          &lt;dttm&gt;              &lt;date&gt;     &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; 1 Birrarung Marr 2015-01-01 00:00:00 2015-01-01     0  1630</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; 2 Birrarung Marr 2015-01-01 01:00:00 2015-01-01     1   826</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; 3 Birrarung Marr 2015-01-01 02:00:00 2015-01-01     2   567</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; 4 Birrarung Marr 2015-01-01 03:00:00 2015-01-01     3   264</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; 5 Birrarung Marr 2015-01-01 04:00:00 2015-01-01     4   139</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; # â€¦ with 7.017e+04 more rows</span></a></code></pre></div>
<div id="fixed-window-size" class="section level2">
<h2 class="hasAnchor">
<a href="#fixed-window-size" class="anchor"></a>Fixed window size</h2>
<p>Moving average is one of the common techniques to smooth time series. We can apply daily window smoother (a fixed window size of 24) easily for each sensor. <code><a href="../reference/slide.html">slide()</a></code> returns an output the same length as the input with <code>.fill = NA</code> (by default) and <code>.align = "center-left"</code> padded at both sides of the data range, so that the result fits into <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> in harmony. <code><a href="../reference/slide.html">slide_dbl()</a></code> produces the numeric vector returned by <code><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">pedestrian_full <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(Sensor) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">Daily_MA =</span> <span class="kw"><a href="../reference/slide.html">slide_dbl</a></span>(Count, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">.size =</span> <span class="dv">24</span>, <span class="dt">.align =</span> <span class="st">"center-left"</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  ))</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; # A tsibble: 70,176 x 6 [1h] &lt;Australia/Melbourne&gt;</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; # Key:       Sensor [4]</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; # Groups:    Sensor [4]</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;   Sensor         Date_Time           Date        Time Count Daily_MA</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;   &lt;chr&gt;          &lt;dttm&gt;              &lt;date&gt;     &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; 1 Birrarung Marr 2015-01-01 00:00:00 2015-01-01     0  1630       NA</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; 2 Birrarung Marr 2015-01-01 01:00:00 2015-01-01     1   826       NA</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; 3 Birrarung Marr 2015-01-01 02:00:00 2015-01-01     2   567       NA</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; 4 Birrarung Marr 2015-01-01 03:00:00 2015-01-01     3   264       NA</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; 5 Birrarung Marr 2015-01-01 04:00:00 2015-01-01     4   139       NA</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; # â€¦ with 7.017e+04 more rows</span></a></code></pre></div>
<p>To make this even-order moving average symmetric, a second moving average with <code>.size = 2</code> should be applied to <code>Daily_MA</code>.</p>
</div>
<div id="flexible-calendar-period" class="section level2">
<h2 class="hasAnchor">
<a href="#flexible-calendar-period" class="anchor"></a>Flexible calendar period</h2>
<p>What if the time period weâ€™d like to slide over happens not to be a fixed window size, for example sliding over three months. The preprocessing step is to wrap observations into monthly subsets (a list of tsibbles) using <code><a href="https://tidyr.tidyverse.org/reference/nest.html">nest()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">pedestrian_mth &lt;-<span class="st"> </span>pedestrian_full <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">YrMth =</span> <span class="kw"><a href="../reference/period.html">yearmonth</a></span>(Date_Time)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span>(<span class="op">-</span>Sensor, <span class="op">-</span>YrMth)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">pedestrian_mth</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; # A tibble: 96 x 3</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;   Sensor            YrMth data               </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;   &lt;chr&gt;             &lt;mth&gt; &lt;list&gt;             </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; 1 Birrarung Marr 2015 Jan &lt;tsibble [744 Ã— 4]&gt;</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; 2 Birrarung Marr 2015 Feb &lt;tsibble [672 Ã— 4]&gt;</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; 3 Birrarung Marr 2015 Mar &lt;tsibble [744 Ã— 4]&gt;</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; 4 Birrarung Marr 2015 Apr &lt;tsibble [721 Ã— 4]&gt;</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; 5 Birrarung Marr 2015 May &lt;tsibble [744 Ã— 4]&gt;</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; # â€¦ with 91 more rows</span></a></code></pre></div>
<p>Now itâ€™s ready to (rock and) roll. When setting <code>.size = 1</code> in <code><a href="../reference/slide.html">slide()</a></code>, it behaves exactly the same as <code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map()</a></code>, mapping over each element in the object. However, <code>(1)</code> a bundle of 3 subsets (<code>.size = 3</code>) needs to be binded first and then computed for average counts; <code>(2)</code> alternatively, <code>.bind = TRUE</code> takes care of binding data frames by row. The nicely-glued simple operations facilitate complex tasks in an easier-to-comprehend manner.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">pedestrian_mth <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(Sensor) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="co"># (1)</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="co"># mutate(Monthly_MA = slide_dbl(data, </span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="co">#   ~ mean(bind_rows(.)$Count, na.rm = TRUE), .size = 3, .align = "center"</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="co"># ))</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span><span class="co"># (2) equivalent to (1)</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">Monthly_MA =</span> <span class="kw"><a href="../reference/slide.html">slide_dbl</a></span>(data, </a>
<a class="sourceLine" id="cb4-9" data-line-number="9">    <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(.<span class="op">$</span>Count, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">.size =</span> <span class="dv">3</span>, <span class="dt">.align =</span> <span class="st">"center"</span>, <span class="dt">.bind =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">  ))</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; # A tibble: 96 x 4</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; # Groups:   Sensor [4]</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;   Sensor            YrMth data                Monthly_MA</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;   &lt;chr&gt;             &lt;mth&gt; &lt;list&gt;                   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; 1 Birrarung Marr 2015 Jan &lt;tsibble [744 Ã— 4]&gt;        NA </span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; 2 Birrarung Marr 2015 Feb &lt;tsibble [672 Ã— 4]&gt;       634.</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; 3 Birrarung Marr 2015 Mar &lt;tsibble [744 Ã— 4]&gt;       546.</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; 4 Birrarung Marr 2015 Apr &lt;tsibble [721 Ã— 4]&gt;       554.</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; 5 Birrarung Marr 2015 May &lt;tsibble [744 Ã— 4]&gt;       397.</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt; # â€¦ with 91 more rows</span></a></code></pre></div>
</div>
<div id="row-oriented-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#row-oriented-workflow" class="anchor"></a>Row-oriented workflow</h2>
<p>We have had a glimpse at <a href="https://github.com/jennybc/row-oriented-workflows">row-oriented workflow</a> to slide over consecutive months using <code><a href="https://tidyr.tidyverse.org/reference/nest.html">nest()</a></code> in the preceding example. To leverage this workflow more, we can fit a linear model for each sensor simultaneously but independently, and in turn obtain its fitted values and residuals over weekly rolling windows. This is where <code><a href="../reference/slide2.html">pslide()</a></code> comes to play. It takes a list or a data frame (multiple inputs) and apply the custom function <code>my_diag()</code> to every rolling block. We start with a tsibble and end up with a diagnostic tibble of relatively larger size.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">my_diag &lt;-<span class="st"> </span><span class="cf">function</span>(...) {</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  data &lt;-<span class="st"> </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(...)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(Count <span class="op">~</span><span class="st"> </span>Time, <span class="dt">data =</span> data)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">fitted =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/fitted.values">fitted</a></span>(fit), <span class="dt">resid =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/residuals">residuals</a></span>(fit))</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">pedestrian <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="../reference/filter_index.html">filter_index</a></span>(<span class="op">~</span><span class="st"> "2015-03"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span>(<span class="op">-</span>Sensor) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">diag =</span> purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span>(data, <span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/slide2.html">pslide_dfr</a></span>(., my_diag, <span class="dt">.size =</span> <span class="dv">24</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>)))</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; # A tibble: 4 x 3</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;   Sensor                        data                  diag                 </span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;   &lt;chr&gt;                         &lt;list&gt;                &lt;list&gt;               </span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; 1 Birrarung Marr                &lt;tsibble [2,160 Ã— 4]&gt; &lt;tibble [334,825 Ã— 2â€¦</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; 2 Bourke Street Mall (North)    &lt;tsibble [1,032 Ã— 4]&gt; &lt;tibble [145,321 Ã— 2â€¦</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; 3 QV Market-Elizabeth St (West) &lt;tsibble [2,160 Ã— 4]&gt; &lt;tibble [334,825 Ã— 2â€¦</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; 4 Southern Cross Station        &lt;tsibble [2,160 Ã— 4]&gt; &lt;tibble [334,825 Ã— 2â€¦</span></a></code></pre></div>
<p>Why <code><a href="../reference/slide.html">slide()</a></code> not working for this case? It is intended to work with a list, i.e.Â column-by-column for a data frame. However, here we perform a row-wise sliding over multiple columns of a data frame at one, <code><a href="../reference/slide2.html">pslide()</a></code> does the job for handling multiple lists. This example running a bit longer? Time to kick <a href="https://davisvaughan.github.io/furrr/"><strong>furrr</strong></a> in for parallel processing. Their multiprocessing counterparts are all prefixed with <code>future_</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(furrr)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">plan</span>(multiprocess)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">pedestrian <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/filter_index.html">filter_index</a></span>(<span class="op">~</span><span class="st"> "2015-03"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span>(<span class="op">-</span>Sensor) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">diag =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/furrr/topics/future_map">future_map</a></span>(data, <span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/future-slide.html">future_pslide_dfr</a></span>(., my_diag, <span class="dt">.size =</span> <span class="dv">24</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>)))</a></code></pre></div>
</div>
<div id="other-features" class="section level2">
<h2 class="hasAnchor">
<a href="#other-features" class="anchor"></a>Other features</h2>
<p>The <code><a href="../reference/slide.html">slide()</a></code> examples default to sliding over complete sets. In some cases, you may find partial sliding more appropriate, which can be enabled by <code>.partial = TRUE</code>. Additionally, as opposed to moving window forward by a positive <code>.size</code>, a negative one moves window backward.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#fixed-window-size">Fixed window size</a></li>
      <li><a href="#flexible-calendar-period">Flexible calendar period</a></li>
      <li><a href="#row-oriented-workflow">Row-oriented workflow</a></li>
      <li><a href="#other-features">Other features</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://earo.me">Earo Wang</a>, <a href="http://dicook.org">Di Cook</a>, <a href="http://robjhyndman.com">Rob Hyndman</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'b7cf533da009fba6bd7a07d530e0824e',
    indexName: 'tsibble',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
